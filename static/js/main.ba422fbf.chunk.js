(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{38:function(e,t,n){},62:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),a=n(32),o=n.n(a),i=(n(38),n(1)),s=n(10),u=n(6),l=n(5),f=n.n(l),m=(n(62),n(33)),d=n.n(m),p=n(0),h=function(e){var t=e.gameOver,n=e.setupComplete,c=e.setupConfirmed,a=e.human,o=e.computer;function i(e,t){return 1===e.length?"span-columns":0===t?"my-board":"computer"}Object(r.useEffect)((function(){var t=document.querySelector(".my-board");t&&(t.classList.toggle("hidden"),setTimeout((function(){t.classList.toggle("hidden")}),e.lag))}),[a,o,e.lag]);return Object(p.jsxs)("section",{id:"notifications",className:"span-columns",children:[n&&!c&&Object(p.jsx)("div",{className:"span-columns",children:Object(p.jsx)("button",{onClick:e.onConfirmSetup,className:"activated span-columns",children:"Start Game"})}),function(e){if(e)return e.map((function(t,n){return Object(p.jsx)("p",{className:i(e,n),children:t},n)}))}(n?t?["Game over. ".concat(t," won!")]:a.history[0]?[a,o].map((function(e){var t=e.history[e.history.length-1],n=e.board[t[0]][t[1]];return n?e.ships[n].isSunk(e.ships[n].hits)?"".concat(d()(n)," sunk!"):"Hit!":"Miss!"})):void 0:["Place all ships on the board"]),t&&Object(p.jsx)("div",{className:"span-columns",children:Object(p.jsx)("button",{className:"activated span-columns",onClick:e.onReset,children:"Play Again"})})]})},v=n(9),b=n(17),j=function(e){var t=e.human,n=t.ships,c=Object(r.useState)({carrier:!0,battleship:!0,cruiser:!0,submarine:!0,minesweeper:!0}),a=Object(s.a)(c,2),o=a[0],u=a[1];function l(e){var t=e.target.closest("ul").className.split(" ")[1];u(Object(i.a)(Object(i.a)({},o),{},Object(v.a)({},t,!o[t])))}function f(e){var t=this,n=e.explicitOriginalTarget.closest("li").className.split(" ")[0].split("_")[1],r=this.className.split(" ")[1];e.dataTransfer.setData("text/plain","".concat(n," ").concat(r)),setTimeout((function(){return t.classList.add("no-display")}),0)}function m(e){var n=this.className.split(" ")[1];t.board.some((function(e){return e.some((function(e){return e===n}))}))||this.classList.remove("no-display")}function d(e){e.preventDefault()}function h(t){var n=this.closest("li"),r=t.dataTransfer.getData("text/plain"),c=r.split(" ")[1],a=function(e,t,n){var r=e.className.split(" ")[0].split("_");return r.shift(),r=r.map((function(e){return Number(e)})),o[t]?r[1]-=n:r[0]-=n,r}(n,c,Number(r.split(" ")[0]));if(a.some((function(e){return e<0})))return!1;var i={coords:a,horizontal:o[c]};e.onPlacement(c,i)}function j(e){return{gridRow:"1 / span ".concat(e),width:"25px",gridTemplateColumns:"25px",gridTemplateRows:"repeat(".concat(e,", 25px)")}}Object(r.useEffect)((function(){var e=document.querySelector("#setup").querySelectorAll(".ship"),t=document.querySelector("#board").querySelectorAll(".cell");return function(e,t){e.forEach((function(e){e.addEventListener("click",l),e.addEventListener("dragstart",f),e.addEventListener("dragend",m)}));var n,r=Object(b.a)(t);try{for(r.s();!(n=r.n()).done;){var c=n.value;c.addEventListener("dragover",d),c.addEventListener("drop",h)}}catch(a){r.e(a)}finally{r.f()}}(e,t),function(){return function(e,t){e.forEach((function(e){e.removeEventListener("click",l),e.removeEventListener("dragstart",f),e.removeEventListener("dragend",m)}));var n,r=Object(b.a)(t);try{for(r.s();!(n=r.n()).done;){var c=n.value;c.removeEventListener("dragover",d),c.removeEventListener("drop",h)}}catch(a){r.e(a)}finally{r.f()}}(e,t)}}));var O=function(e){for(var t=[],n=0;n<e.length;n++)t.push(Object(p.jsx)("li",{className:"_".concat(n," part"),children:Object(p.jsx)("span",{})},n));return t},g=Object.values(n).map((function(e,t){return Object(p.jsx)("ul",{className:"ship ".concat(e.name),draggable:"true",style:o[e.name]?(n=e.length,{gridColumn:"1 / span ".concat(n),width:"".concat(25*n,"px"),gridTemplateColumns:"repeat(".concat(n,", 25px)"),gridTemplateRows:"25px"}):j(e.length),children:O(e)},t);var n}));return Object(p.jsxs)("section",{id:"setup",children:[Object(p.jsx)("div",{className:"shipyard",children:g}),Object(p.jsxs)("p",{children:["- click on a ship to rotate",Object(p.jsx)("br",{}),"- click on the board to reset a ship"]})]})},O=function(e){var t=e.human,n=t.board,c=t.history;function a(t){var n=this.closest("li").className.split(" ")[1];e.onRemove(n),document.querySelector("#setup").querySelector(".".concat(n)).classList.remove("no-display")}function o(){if(c[0]){var e=c[c.length-1],t=n[e[0]][e[1]]?"hit":"shot";document.querySelector("#board").querySelector("._".concat(e.join("_"))).classList.add(t)}}function i(t,n,r){return r?e.setupConfirmed?"_".concat(t,"_").concat(n," ").concat(r," cell"):"_".concat(t,"_").concat(n," ").concat(r," setup cell"):"_".concat(t,"_").concat(n," cell")}Object(r.useEffect)((function(){if(!e.setupComplete){setTimeout(o,e.lag);var t=document.querySelector("#board").querySelectorAll(".cell:not(.false)");return t.forEach((function(e){e.addEventListener("click",a)})),function(){t.forEach((function(e){e.removeEventListener("click",a)}))}}}));var s=n.map((function(e,t){return e.map((function(e,n){return Object(p.jsx)("li",{className:i(t,n,e),children:Object(p.jsx)("span",{})},"_".concat(t,"_").concat(n))}))}));return Object(p.jsxs)("section",{id:"board",className:e.setupConfirmed?"board":"board span-columns",children:[Object(p.jsx)("h3",{className:e.setupConfirmed?"":"hidden",children:"My Board"}),Object(p.jsx)("ul",{children:s}),!e.setupConfirmed&&Object(p.jsx)(j,{human:e.human,onPlacement:e.onPlacement})]})},g=function(e){var t=e.computer,n=t.board,c=t.history;Object(r.useEffect)((function(){return function(){if(!c[0])return;var e=c[c.length-1],t=n[e[0]][e[1]]?"hit":"shot";document.querySelector("#other-board").querySelector("._".concat(e.join("_"))).classList.add(t)}()})),function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=t}),[t]),Object(r.useEffect)((function(){var t=document.querySelector("#other-board").querySelectorAll(".cell"),r=function(e){return n.current(e)};return t.forEach((function(t){t.addEventListener(e,r)})),function(){t.forEach((function(t){t.removeEventListener(e,r)}))}}),[e])}("click",(function(t){var n=t.target.closest("li").className.split(" ")[0].split("_");n.shift(),n=n.map((function(e){return Number(e)})),e.onAttack(n)}));var a=n.map((function(e,t){return e.map((function(e,n){return Object(p.jsx)("li",{className:"_".concat(t,"_").concat(n," cell"),children:Object(p.jsx)("span",{children:e[0]})},"_".concat(t,"_").concat(n))}))}));return Object(p.jsxs)("section",{id:"other-board",className:"board",children:[Object(p.jsx)("h3",{children:"Computer"}),Object(p.jsx)("ul",{children:a})]})},y=n(20),x=function(){var e=function(e,t,n){var r=[];if(n)for(var c=0;c<e.length;c++)r.push([t[0],t[1]+c]);else for(var a=0;a<e.length;a++)r.push([t[0]+a,t[1]]);return r},t=function(e){return e.flat().some((function(e){return e>=10}))},n=function(e,t){return e.some((function(e){return t[e[0]][e[1]]}))},r=function(e,t,n){var r=n.map((function(e){return Object(y.a)(e)}));return t.forEach((function(t){r[t[0]][t[1]]=e.name})),r};return{place:function(c,a,o){var i=a.coords,s=a.horizontal,u=o.board,l=e(c,i,s);return!t(l)&&!n(l,u)&&r(c,l,u)},remove:function(e,t){return t.board.map((function(t){return t.map((function(t){return t!==e.name&&t}))}))},allShipsPlaced:function(e){return Object.values(e.ships).map((function(e){return e.name})).every((function(t){return e.board.flat().some((function(e){return e===t}))}))},receiveAttack:function(e,t){var n=t.board,r=t.history;if(r.find((function(t){return t[0]===e[0]&&t[1]===e[1]})))return!1;var c=n[e[0]][e[1]],a=t.ships[c],o=!!c&&a.hit(a.hits);return{history:[].concat(Object(y.a)(r),[e]),target:c,hits:o}},allSunk:function(e){return e.board.every((function(t){return t.every((function(t){var n=e.ships[t];return!t||n.isSunk(n.hits)}))}))}}},S=n(11),E=n.n(S),C=n(18),N=n.n(C),k=n(19),L=n.n(k),_=function(){var e=x(),t=function(e){var t=n(e);return!!t&&r(t).filter((function(e){return e.every((function(e){return E()(0,10).includes(e)}))}))},n=function(e){var t=e.board,n=e.ships,r=e.history,c=Object.values(n).find((function(e){return!e.isSunk(e.hits)&&e.hits>0}));return!!c&&r.filter((function(e){return t[e[0]][e[1]]===c.name}))},r=function(e){var t=[];return 1!==(e=[e.map((function(e){return e[0]})),e.map((function(e){return e[1]}))])[0].length&&e[0][0]===e[0][1]||(t.push([N()(e[0])+1,e[1][0]]),t.push([L()(e[0])-1,e[1][0]])),1!==e[1].length&&e[1][0]===e[1][1]||(t.push([e[0][0],N()(e[1])+1]),t.push([e[0][0],L()(e[1])-1])),t},c=function(){return E()(0,10).map((function(e){return E()(0,10).map((function(t){return[e,t]}))})).flat()},a=function(e,t){return e.filter((function(e){return t.every((function(t){return e[0]!==t[0]||e[1]!==t[1]}))}))};return{gameboard:e,calculateMoves:function(e){var n=e.history,r=t(e)||c();return a(r,n)},autoPlace:function(t,n){var r;do{var a={coords:f()(c()),horizontal:f()([!0,!1])};r=e.place(t,a,n)}while(!r);return r}}},q=function(e,t){return{name:e,length:t,hit:function(e){return e+1},isSunk:function(e){return t-e===0}}},A={board:Array(10).fill().map((function(){return Array(10).fill(!1)})),ships:{carrier:Object(i.a)(Object(i.a)({},q("carrier",5)),{},{hits:0}),battleship:Object(i.a)(Object(i.a)({},q("battleship",4)),{},{hits:0}),cruiser:Object(i.a)(Object(i.a)({},q("cruiser",3)),{},{hits:0}),submarine:Object(i.a)(Object(i.a)({},q("submarine",3)),{},{hits:0}),minesweeper:Object(i.a)(Object(i.a)({},q("minesweeper",2)),{},{hits:0})},history:[]},w={setupConfirmed:!1,gameOver:!1,human:Object(i.a)({},A),computer:Object(i.a)({},A)};var P=function(){var e=_(),t=e.gameboard,n=1e3,c=Object(r.useState)(v()),a=Object(s.a)(c,2),o=a[0],l=a[1],m=o.human,d=o.computer;function v(){var t=w,n=function(n){var r=t.computer,c=e.autoPlace(r.ships[n],r);t=Object(u.a)(t,(function(e){e.computer.board=c}))};for(var r in t.computer.ships)n(r);return t}function b(){l(Object(i.a)(Object(i.a)({},o),{},{setupConfirmed:!0}))}function j(e,n,r,c){n.target&&(e[r].ships[n.target].hits=n.hits,e.gameOver=!!t.allSunk(e[r])&&c),e[r].history=n.history}return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(h,{human:m,computer:d,setupConfirmed:o.setupConfirmed,gameOver:o.gameOver,lag:n,setupComplete:t.allShipsPlaced(m),onConfirmSetup:b,onReset:function(){l(v()),document.querySelectorAll(".cell").forEach((function(e){e.classList.remove("shot"),e.classList.remove("hit")}))}}),Object(p.jsx)(O,{human:m,setupConfirmed:o.setupConfirmed,lag:n,onRemove:function(e){var n=t.remove(m.ships[e],m),r=Object(u.a)(o,(function(e){e.human.board=n}));l(r)},onPlacement:function(e,n){var r=t.place(m.ships[e],n,m);if(r){var c=Object(u.a)(o,(function(e){e.human.board=r}));l(c)}},onConfirmSetup:b}),o.setupConfirmed&&Object(p.jsx)(g,{computer:d,gameOver:o.gameOver,lag:n,onAttack:function(n){var r=t.receiveAttack(n,d);if(r){var c=f()(e.calculateMoves(m)),a=t.receiveAttack(c,m),i=Object(u.a)(o,(function(e){j(e,r,"computer","You"),j(e,a,"human","Computer")}));l(i)}}})]})};o.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(P,{})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.ba422fbf.chunk.js.map