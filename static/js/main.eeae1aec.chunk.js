(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{37:function(e,t,n){},61:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),o=n(31),a=n.n(o),i=(n(37),n(1)),u=n(11),s=n(6),l=n(5),f=n.n(l),m=(n(61),n(32)),p=n.n(m),h=n(0),d=function(e){var t=e.gameOver,n=e.setupComplete,c=e.setupConfirmed,o=e.human,a=e.computer;function i(e,t){return 1===e.length?"span-columns":0===t?"my-board":"computer"}Object(r.useEffect)((function(){var t=document.querySelector(".my-board");t&&(t.classList.toggle("hidden"),setTimeout((function(){t.classList.toggle("hidden")}),e.lag))}),[o,a,e.lag]);return Object(h.jsxs)("section",{id:"notifications",className:"span-columns",children:[n&&!c&&Object(h.jsx)("div",{className:"span-columns",children:Object(h.jsx)("button",{onClick:e.onConfirmSetup,className:"activated span-columns",children:"Start Game"})}),function(e){if(e)return e.map((function(t,n){return Object(h.jsx)("p",{className:i(e,n),children:t},n)}))}(n?t?["Game over. ".concat(t," won!")]:o.history[0]?[o,a].map((function(e){var t=e.history[e.history.length-1],n=e.board[t[0]][t[1]];return n?e.ships[n].isSunk(e.ships[n].hits)?"".concat(p()(n)," sunk!"):"Hit!":"Miss!"})):void 0:["Place all ships on the board"]),t&&Object(h.jsx)("div",{className:"span-columns",children:Object(h.jsx)("button",{className:"activated span-columns",onClick:e.onReset,children:"Play Again"})})]})},b=n(9),v=n(3),j=n.n(v),O=function(e){var t=e.ships,n=Object(r.useState)({carrier:!0,battleship:!0,cruiser:!0,submarine:!0,minesweeper:!0}),c=Object(u.a)(n,2),o=c[0],a=c[1];function s(t){var n=[t.clientX,t.clientY],r=t.target.closest("ul"),c=t.target.closest("li"),u=r.className.split(" ")[1],s=c.className.split(" ")[0].split("_")[1],l=t.clientX-r.getBoundingClientRect().left,f=function(e){var t=e.cloneNode(!0);return t.style.position="absolute",document.body.append(t),e.classList.toggle("no-display"),t}(r);function m(e,t){f.style.left=e-l+"px",f.style.top=t-f.offsetHeight/2+"px"}function p(e){m(e.pageX,e.pageY)}m(t.pageX,t.pageY),document.addEventListener("mousemove",p),f.addEventListener("mouseup",(function(t){var c=[t.clientX,t.clientY];document.removeEventListener("mousemove",p),function(e,t){return j()(0,3).includes(t[0]-e[0])&&j()(0,3).includes(t[1]-e[1])}(n,c)&&function(e){a(Object(i.a)(Object(i.a)({},o),{},Object(b.a)({},e,!o[e])))}(u);var l=function(e,t){return document.body.removeChild(t),document.elementFromPoint(e.clientX,e.clientY).closest(".cell")}(t,f);if(l){var m=function(e,t,n){var r=e.className.split(" ")[0].split("_");return r.shift(),r=r.map((function(e){return Number(e)})),o[t]?r[1]-=n:r[0]-=n,!r.some((function(e){return e<0}))&&r}(l,u,s),h={coords:m,horizontal:o[u]};if(m&&e.onPlacement(u,h))return}r.classList.toggle("no-display")}))}function l(e){return{gridRow:"1 / span ".concat(e),width:"25px",gridTemplateColumns:"25px",gridTemplateRows:"repeat(".concat(e,", 25px)")}}Object(r.useEffect)((function(){var e=document.querySelectorAll(".ship");return e.forEach((function(e){e.addEventListener("mousedown",s)})),function(){e.forEach((function(e){e.removeEventListener("mousedown",s)}))}}));var f=function(e){for(var t=[],n=0;n<e.length;n++)t.push(Object(h.jsx)("li",{className:"_".concat(n," part"),children:Object(h.jsx)("span",{})},n));return t},m=Object.values(t).map((function(e,t){return Object(h.jsx)("ul",{className:"ship ".concat(e.name),style:o[e.name]?(n=e.length,{gridColumn:"1 / span ".concat(n),width:"".concat(25*n,"px"),gridTemplateColumns:"repeat(".concat(n,", 25px)"),gridTemplateRows:"25px"}):l(e.length),children:f(e)},t);var n}));return Object(h.jsxs)("section",{id:"setup",children:[Object(h.jsx)("div",{className:"shipyard",children:m}),Object(h.jsxs)("p",{children:["- click on a ship to rotate",Object(h.jsx)("br",{}),"- click on the board to reset a ship"]})]})},g=function(e){var t=e.human,n=t.board,c=t.history;t.ships;function o(t){var n=this.closest("li").className.split(" ")[1];e.onRemove(n),document.querySelector(".".concat(n)).classList.toggle("no-display")}function a(){if(c[0]){var e=c[c.length-1],t=n[e[0]][e[1]]?"hit":"shot";document.querySelector("#board").querySelector("._".concat(e.join("_"))).classList.add(t)}}function i(t,n,r){return r?e.setupConfirmed?"_".concat(t,"_").concat(n," ").concat(r," cell"):"_".concat(t,"_").concat(n," ").concat(r," setup cell"):"_".concat(t,"_").concat(n," cell")}Object(r.useEffect)((function(){if(!e.setupComplete){setTimeout(a,e.lag);var t=document.querySelector("#board").querySelectorAll(".cell:not(.false)");return t.forEach((function(e){e.addEventListener("click",o)})),function(){t.forEach((function(e){e.removeEventListener("click",o)}))}}}));var u=n.map((function(e,t){return e.map((function(e,n){return Object(h.jsx)("li",{className:i(t,n,e),children:Object(h.jsx)("span",{})},"_".concat(t,"_").concat(n))}))}));return Object(h.jsxs)("section",{id:"board",className:e.setupConfirmed?"board":"board span-columns",children:[Object(h.jsx)("h3",{className:e.setupConfirmed?"":"hidden",children:"My Board"}),Object(h.jsx)("ul",{children:u}),!e.setupConfirmed&&Object(h.jsx)(O,{ships:e.human.ships,onPlacement:e.onPlacement})]})},y=function(e){var t=e.computer,n=t.board,c=t.history;Object(r.useEffect)((function(){return function(){if(!c[0])return;var e=c[c.length-1],t=n[e[0]][e[1]]?"hit":"shot";document.querySelector("#other-board").querySelector("._".concat(e.join("_"))).classList.add(t)}()})),function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=t}),[t]),Object(r.useEffect)((function(){var t=document.querySelector("#other-board").querySelectorAll(".cell"),r=function(e){return n.current(e)};return t.forEach((function(t){t.addEventListener(e,r)})),function(){t.forEach((function(t){t.removeEventListener(e,r)}))}}),[e])}("click",(function(t){var n=t.target.closest("li").className.split(" ")[0].split("_");n.shift(),n=n.map((function(e){return Number(e)})),e.onAttack(n)}));var o=n.map((function(e,t){return e.map((function(e,n){return Object(h.jsx)("li",{className:"_".concat(t,"_").concat(n," cell"),children:Object(h.jsx)("span",{})},"_".concat(t,"_").concat(n))}))}));return Object(h.jsxs)("section",{id:"other-board",className:"board",children:[Object(h.jsx)("h3",{children:"Computer"}),Object(h.jsx)("ul",{children:o})]})},x=n(19),C=function(){var e=function(e,t,n){var r=[];if(n)for(var c=0;c<e.length;c++)r.push([t[0],t[1]+c]);else for(var o=0;o<e.length;o++)r.push([t[0]+o,t[1]]);return r},t=function(e){return e.flat().some((function(e){return e>=10}))},n=function(e,t){return e.some((function(e){return t[e[0]][e[1]]}))},r=function(e,t,n){var r=n.map((function(e){return Object(x.a)(e)}));return t.forEach((function(t){r[t[0]][t[1]]=e.name})),r};return{place:function(c,o,a){var i=o.coords,u=o.horizontal,s=a.board,l=e(c,i,u);return!t(l)&&!n(l,s)&&r(c,l,s)},remove:function(e,t){return t.board.map((function(t){return t.map((function(t){return t!==e.name&&t}))}))},allShipsPlaced:function(e){return Object.values(e.ships).map((function(e){return e.name})).every((function(t){return e.board.flat().some((function(e){return e===t}))}))},receiveAttack:function(e,t){var n=t.board,r=t.history;if(r.find((function(t){return t[0]===e[0]&&t[1]===e[1]})))return!1;var c=n[e[0]][e[1]],o=t.ships[c],a=!!c&&o.hit(o.hits);return{history:[].concat(Object(x.a)(r),[e]),target:c,hits:a}},allSunk:function(e){return e.board.every((function(t){return t.every((function(t){var n=e.ships[t];return!t||n.isSunk(n.hits)}))}))}}},S=n(17),E=n.n(S),N=n(18),k=n.n(N),_=function(){var e=C(),t=function(e){var t=n(e);return!!t&&r(t).filter((function(e){return e.every((function(e){return j()(0,10).includes(e)}))}))},n=function(e){var t=e.board,n=e.ships,r=e.history,c=Object.values(n).find((function(e){return!e.isSunk(e.hits)&&e.hits>0}));return!!c&&r.filter((function(e){return t[e[0]][e[1]]===c.name}))},r=function(e){var t=[];return 1!==(e=[e.map((function(e){return e[0]})),e.map((function(e){return e[1]}))])[0].length&&e[0][0]===e[0][1]||(t.push([E()(e[0])+1,e[1][0]]),t.push([k()(e[0])-1,e[1][0]])),1!==e[1].length&&e[1][0]===e[1][1]||(t.push([e[0][0],E()(e[1])+1]),t.push([e[0][0],k()(e[1])-1])),t},c=function(){return j()(0,10).map((function(e){return j()(0,10).map((function(t){return[e,t]}))})).flat()},o=function(e,t){return e.filter((function(e){return t.every((function(t){return e[0]!==t[0]||e[1]!==t[1]}))}))};return{gameboard:e,calculateMoves:function(e){var n=e.history,r=t(e)||c();return o(r,n)},autoPlace:function(t,n){var r;do{var o={coords:f()(c()),horizontal:f()([!0,!1])};r=e.place(t,o,n)}while(!r);return r}}},L=function(e,t){return{name:e,length:t,hit:function(e){return e+1},isSunk:function(e){return t-e===0}}},w={board:Array(10).fill().map((function(){return Array(10).fill(!1)})),ships:{carrier:Object(i.a)(Object(i.a)({},L("carrier",5)),{},{hits:0}),battleship:Object(i.a)(Object(i.a)({},L("battleship",4)),{},{hits:0}),cruiser:Object(i.a)(Object(i.a)({},L("cruiser",3)),{},{hits:0}),submarine:Object(i.a)(Object(i.a)({},L("submarine",3)),{},{hits:0}),minesweeper:Object(i.a)(Object(i.a)({},L("minesweeper",2)),{},{hits:0})},history:[]},A={setupConfirmed:!1,gameOver:!1,human:Object(i.a)({},w),computer:Object(i.a)({},w)};var q=function(){var e=_(),t=e.gameboard,n=Object(r.useState)(p()),c=Object(u.a)(n,2),o=c[0],a=c[1],l=o.human,m=o.computer;function p(){var t=A,n=function(n){var r=t.computer,c=e.autoPlace(r.ships[n],r);t=Object(s.a)(t,(function(e){e.computer.board=c}))};for(var r in t.computer.ships)n(r);return t}function b(){a(Object(i.a)(Object(i.a)({},o),{},{setupConfirmed:!0}))}function v(e,n,r,c){n.target&&(e[r].ships[n.target].hits=n.hits,e.gameOver||(e.gameOver=!!t.allSunk(e[r])&&c)),e[r].history=n.history}return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(d,{human:l,computer:m,setupConfirmed:o.setupConfirmed,gameOver:o.gameOver,lag:100,setupComplete:t.allShipsPlaced(l),onConfirmSetup:b,onReset:function(){a(p()),document.querySelectorAll(".cell").forEach((function(e){e.classList.remove("shot"),e.classList.remove("hit")}))}}),Object(h.jsx)(g,{human:l,setupConfirmed:o.setupConfirmed,lag:100,onRemove:function(e){var n=t.remove(l.ships[e],l),r=Object(s.a)(o,(function(e){e.human.board=n}));a(r)},onPlacement:function(e,n){var r=t.place(l.ships[e],n,l);if(r){var c=Object(s.a)(o,(function(e){e.human.board=r}));return a(c),!0}return!1},onConfirmSetup:b}),o.setupConfirmed&&Object(h.jsx)(y,{computer:m,gameOver:o.gameOver,lag:100,onAttack:function(n){var r=t.receiveAttack(n,m);if(r){var c=f()(e.calculateMoves(l)),i=t.receiveAttack(c,l),u=Object(s.a)(o,(function(e){v(e,r,"computer","You"),v(e,i,"human","Computer")}));a(u)}}})]})};a.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(q,{})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.eeae1aec.chunk.js.map